package preformattedConverter;

import com.opencsv.CSVReader;
import com.opencsv.exceptions.CsvException;

import java.io.*;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

public class PreformattedCsvConverter {
  public static void main(String[] args) throws IOException {
    int size = 1000;

    Map<String, Integer> sequenceTypeToNumber = new HashMap<>();
    sequenceTypeToNumber.put("Clean", 0);
    sequenceTypeToNumber.put("AdWare", 1);
    sequenceTypeToNumber.put("Trojan", 2);
    sequenceTypeToNumber.put("Downloader", 3);
    sequenceTypeToNumber.put("WebToolbar", 4);
    sequenceTypeToNumber.put("DangerousObject", 5);


    FileWriter fileWriter = new FileWriter("converted1000.csv");
    PrintWriter printWriter = new PrintWriter(fileWriter);

    List<String> top = new ArrayList<>();
    for (int i =1; i<=size; i++) {
      top.add("C" +i);
    }
    top.add("type");
    printWriter.println(String.join(",", top));

    try (CSVReader reader = new CSVReader(new FileReader("G:\\Downloads\\demo\\malwareDataReader\\src\\main\\resources\\" + size + "_6v2.csv"))) {
      List<String[]> rows = reader.readAll();
      for (String[] row : rows) {
        List<String> convertedRow = new ArrayList<>();
        for (int i = 0; i < row.length; i++) {
          if (i == row.length -1) {
            convertedRow.add(sequenceTypeToNumber.get(row[i]).toString());
          }
          else {
            Integer.parseInt(row[i]);
            convertedRow.add(row[i]);
          }
        }
        printWriter.println(String.join(",", convertedRow));
      }
    } catch (IOException | CsvException e) {
      e.printStackTrace();
    }
  }
}
